"use strict";var m=Object.create;var b=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var r in t)b(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of N(t))!v.call(e,n)&&n!==r&&b(e,n,{get:()=>t[n],enumerable:!(o=w(t,n))||o.enumerable});return e};var S=(e,t,r)=>(r=e!=null?m(k(e)):{},h(t||!e||!e.__esModule?b(r,"default",{value:e,enumerable:!0}):r,e)),Y=e=>h(b({},"__esModule",{value:!0}),e);var $={};I($,{map:()=>R});module.exports=Y($);var A=S(require("deepmerge")),j=S(require("jsonpath")),P={objectMergeMode:"overwrite",arrayMergeMode:"replace"},T=(e,t)=>t,E=(e,t)=>new Array().concat(t).concat(e),W=(e,t)=>e.concat(t);function O(e){return e.startsWith("`")?e.substring(1):e}function C(e){return e.startsWith("$.")}function x(e){return!!e&&typeof e=="object"&&"@path"in e&&typeof(e==null?void 0:e["@path"])=="string"}function _(e){return!!e&&typeof e=="object"&&"@yield"in e&&!!(e!=null&&e["@yield"])}function V(e,t,r,o){let n=r;if(x(r)){if(n=V(e,t,r["@path"],o),r["@transform"]){let i={source:e,schema:r["@path"]};n=r["@transform"](n,t,i)}n===void 0&&r["@default"]!==void 0&&(n=n!=null?n:u(e,t,r["@default"],o))}else if(typeof r=="string")if(C(r)){let i=!0,J=r;r.endsWith("[]")&&(J=r.substring(0,r.length-2),i=!1);let c=j.default.query(e,J);i&&Array.isArray(c)&&c.length<=1?n=c[0]:n=c}else n=O(r);return n}function q(e,t,r,o){let n=t;(!n||typeof n!="object")&&(n={});let i=Object.fromEntries(Object.entries(r).map(([g,y])=>{let d=O(g);return[d,u(e,n[d],y,o)]})),J;switch(o.arrayMergeMode){case"replace":J=T;break;case"concat":J=o.objectMergeMode==="overwrite"?W:E;break}let c=n;switch(o.objectMergeMode){case"overwrite":c=(0,A.default)(n!=null?n:{},i,{arrayMerge:J});break;case"preserve":c=(0,A.default)(i,n!=null?n:{},{arrayMerge:J});break;case"replace":c=i;break}return c}function D(e,t,r,o){let n=t;Array.isArray(t)||(n=[]);let i=r.flatMap((c,g)=>{if(_(c)){let y={};for(let l of c["@yield"])for(let[s,a]of Object.entries(l)){let p=a==null?void 0:a["@padding"],f=u(e,n[g],a,o);if(y[s]){let M=[];M.push(...Array.isArray(y[s][0])?y[s][0]:[y[s][0]],...Array.isArray(f)?f:[f]),y[s]=[M,p!=null?p:y[s][1]]}else y[s]=[f,p]}let d=Math.max(...Object.values(y).map(([l])=>Array.isArray(l)?l.length:1));if(c["@length"]){let l=u(e,null,c["@length"],o);Number.isInteger(l)&&(d=l)}return[...new Array(d).keys()].map(l=>Object.fromEntries(Object.entries(y).map(([s,[a,p]])=>{var f;if(Array.isArray(a))switch(p!=null?p:"empty"){case"empty":return[s,a[l]];case"edge":return[s,(f=a[l])!=null?f:a.at(-1)];case"reflect":return[s,a[(l/a.length|0)%2===0?l%a.length:(a.length-l-1)%a.length]];case"wrap":return[s,a[l%a.length]]}switch(p!=null?p:"edge"){case"empty":return[s,l===0?a:void 0];case"edge":return[s,a];case"reflect":return[s,a];case"wrap":return[s,a]}}).filter(([s,a])=>a!==void 0)))}return[u(e,n[g],c,o)]}),J=n;switch(o.arrayMergeMode){case"replace":J=i;break;case"concat":J=[...n,...i];break;case"combine":J=(0,A.default)(n,i);break}return J}function u(e,t,r,o){return Array.isArray(r)?D(e,t,r,o):typeof r=="object"&&!x(r)?q(e,t,r,o):V(e,t,r,o)}function R(e,t,r,o=null){let n=Object.assign(P,r!=null?r:{});return u(e,o,t,n)}
