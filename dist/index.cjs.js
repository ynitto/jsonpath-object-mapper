"use strict";var x=Object.create;var g=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var v=(e,t)=>{for(var n in t)g(e,n,{get:t[n],enumerable:!0})},h=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of I(t))!k.call(e,r)&&r!==n&&g(e,r,{get:()=>t[r],enumerable:!(a=V(t,r))||a.enumerable});return e};var E=(e,t,n)=>(n=e!=null?x(w(e)):{},h(t||!e||!e.__esModule?g(n,"default",{value:e,enumerable:!0}):n,e)),P=e=>h(g({},"__esModule",{value:!0}),e);var q={};v(q,{map:()=>$});module.exports=P(q);var d=E(require("deepmerge")),S=require("jsonpath-plus"),N={objectMergeMode:"overwrite",arrayMergeMode:"replace"},T=(e,t)=>[...Array(t-e)].map((n,a)=>e+a),O=(e,t)=>t,_=(e,t)=>e;function A(e){return e.startsWith("`")?e.substring(1):e}function W(e){return e.startsWith("$.")}function M(e){return!!e&&typeof e=="object"&&"@path"in e&&typeof e["@path"]=="string"}function C(e){return!!e&&typeof e=="object"&&"@element"in e&&!!e["@element"]&&typeof e["@element"]=="object"}function j(e,t,n,a){let r=n;if(M(n)){if(r=j(e,t,n["@path"],a),n["@default"]!==void 0&&(r=r!=null?r:f(e,t,n["@default"],a)),n["@transform"]){let i={source:e,schema:n["@path"]};r=n["@transform"](r,t,i)}}else if(typeof n=="string")if(W(n)){let i=!0,c=n;n.endsWith("[]")&&(c=n.substring(0,n.length-2),i=!1);let l=(0,S.JSONPath)({path:c,json:e});i&&Array.isArray(l)&&l.length<=1?r=l[0]:r=l}else r=A(n);return r}function D(e,t,n,a){let r=t;(!r||typeof r!="object")&&(r={});let i=Object.fromEntries(Object.entries(n).map(([b,y])=>{let u=A(b);return[u,f(e,r[u],y,a)]})),c;switch(a.arrayMergeMode){case"replace":c=O;break;case"append":case"prepend":switch(a.objectMergeMode){case"overwrite":c=O;break;case"preserve":c=_;break}break}let l=r;switch(a.objectMergeMode){case"overwrite":l=(0,d.default)(r,i,{arrayMerge:c});break;case"preserve":l=(0,d.default)(i,r,{arrayMerge:c});break;case"replace":l=i;break}return l}function R(e,t,n,a){let r=t;Array.isArray(t)||(r=[]);let i=n.flatMap((l,b)=>{if(C(l)){let y={};for(let[o,p]of Object.entries(l["@element"])){let s=p==null?void 0:p["@padding"],J=f(e,r[b],p,a);y[o]=[J,s]}let u=Math.max(...Object.values(y).map(([o])=>Array.isArray(o)?o.length:1));if(l["@length"]){let o=f(e,null,l["@length"],a);Number.isInteger(o)&&(u=o),Array.isArray(o)&&(u=o.length)}return T(0,u).map(o=>Object.fromEntries(Object.entries(y).map(([p,[s,J]])=>{var m;if(Array.isArray(s))switch(J!=null?J:"empty"){case"empty":return[p,s[o]];case"edge":return[p,(m=s[o])!=null?m:s.at(-1)];case"reflect":return[p,s[(o/s.length|0)%2===0?o%s.length:s.length-1-o%s.length]];case"wrap":return[p,s[o%s.length]]}switch(J!=null?J:"edge"){case"empty":return[p,o===0?s:void 0];default:return[p,s]}}).filter(([p,s])=>s!==void 0)))}return[f(e,r[b],l,a)]}),c=r;switch(a.arrayMergeMode){case"replace":c=i;break;case"append":c=[...r,...i];break;case"prepend":c=[...i,...r];break}return c}function f(e,t,n,a){return Array.isArray(n)?R(e,t,n,a):n!=null&&typeof n=="object"&&!M(n)?D(e,t,n,a):j(e,t,n,a)}function $(e,t,n=null,a){let r=Object.assign({},N,a!=null?a:{});return f(e,n,t,r)}
